<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.72">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="דוקומנטציית מסלול מעבדות Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="דוקומנטציית מסלול מעבדות Blog Atom Feed"><title data-react-helmet="true">הטבלאות העיקריות | דוקומנטציית מסלול מעבדות</title><meta data-react-helmet="true" property="og:url" content="https://almogtavor.github.io/lab-results-docs//docs/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="הטבלאות העיקריות | דוקומנטציית מסלול מעבדות"><meta data-react-helmet="true" name="description" content="-   DataFactoryRaw.dbo.LabResults"><meta data-react-helmet="true" property="og:description" content="-   DataFactoryRaw.dbo.LabResults"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://almogtavor.github.io/lab-results-docs//docs/"><link data-react-helmet="true" rel="alternate" href="https://almogtavor.github.io/lab-results-docs//docs/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://almogtavor.github.io/lab-results-docs//docs/" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.9790653f.css">
<link rel="preload" href="/assets/js/styles.8bfe6c99.js" as="script">
<link rel="preload" href="/assets/js/runtime~main.81bbec98.js" as="script">
<link rel="preload" href="/assets/js/main.6adc55ad.js" as="script">
<link rel="preload" href="/assets/js/common.745e6959.js" as="script">
<link rel="preload" href="/assets/js/30.57545e68.js" as="script">
<link rel="preload" href="/assets/js/31.cd6b3c16.js" as="script">
<link rel="preload" href="/assets/js/935f2afb.0ccb021a.js" as="script">
<link rel="preload" href="/assets/js/17896441.7e671925.js" as="script">
<link rel="preload" href="/assets/js/b2f90839.db2696c8.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/labresults.png" alt="Lab Results Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/labresults.png" alt="Lab Results Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">מסלול מעבדות - מפעל המידע</strong></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/">מסמכים</a><a class="navbar__item navbar__link" href="/blog">בלוג</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/almogtavor/labresults-docs" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_GrZ2"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/labresults.png" alt="Lab Results Logo" class="themedImage_1VuW themedImage--light_3UqQ navbar__logo"><img src="/img/labresults.png" alt="Lab Results Logo" class="themedImage_1VuW themedImage--dark_hz6m navbar__logo"><strong class="navbar__title">מסלול מעבדות - מפעל המידע</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/docs/">מסמכים</a></li><li class="menu__list-item"><a class="menu__link" href="/blog">בלוג</a></li><li class="menu__list-item"><a href="https://github.com/almogtavor/labresults-docs" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Docusaurus</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/">הטבלאות העיקריות </a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/doc2">Document Number 2</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/doc3">This is Document Number 3</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Features</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/mdx">Powered by MDX</a></li></ul></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">הטבלאות העיקריות </h1></header><div class="markdown"><h1></h1><ul><li><strong><code>DataFactoryRaw.dbo.LabResults</code> </strong></li></ul><p>בטבלת חומרי הגלם. הטבלה כוללת את נתוני המעבדות כפי שנשלחו הישר מהקבצים.
הטבלה הראשונה אליה המסלול כותב את המידע.</p><ul><li><strong><code>DataFactoryOp.dbo.LabResults_STG</code> </strong></li></ul><p>טבלת הביניים של המסלול. הטבלה אליה החומר נכתב בצורתו המטוייבת – כלומר
לאחר שעבר את הולידציות והטיובים. לאחר שלבי ההפלות וההצלבות עבור כל סגח
החומר נכתב לטבלה זו בצורת insert only כך שרשומה שהגיעה על ידי המעבדה 100
פעמים לצורך העניין, תופיע כאן 100 פעמים, בצורתה המטוייבת (עם ריפוד אפסים
למשל ועוד. <em>ראה ערך טיובים והפלות.</em></p><ul><li><strong><code>DataFactoryMRR.dbo.LabResults</code></strong></li></ul><p>הטבלה המטויבת והשלמה. הטבלה אליה מגיע החומר הסופי לאחר שעבר את המסלול.
זהו הקצה של המסלול למעשה ומהשלב הזה מתחיל שלב ההנגשה. כלומר זוהי הנקודה
המשותפת של כלל לקוחות המידע, ואחריה המידע מונגש מעליה לכל לקוח בצורתו
הספציפית. למשל בטבלאות [DataFactoryMRR].[dbo].[ LabResults_XRM]
עבור הXRM, כview עבור מגן אבות ועוד. בהקשרי המסלול כשאין בלבול נקרא
לטבלה הזו בקיצור MRR.</p><ul><li><strong><code>DataFactoryMRR.dbo.LabResults_SerologyKits</code></strong> </li></ul><p>אדם מבצע מספר בדיקות כדי לקבל תוצאת סרולוגיה (נוגדים לקורונה). המשמעות
היא שהאדם בפועל מבצע בדיקה דרך 2 (או 1 או במקרים מסויימים 3) מכשירים
שונים אשר נקראים קיטים, והחישוב של סכום שתי התוצאות של כל אחד מהקיטים
יניב את התוצאה הסופית. בטבלה LabResults שבMRR יופיעו התוצאות הסופיות
(לפעמים נקרא להם גם תוצאות סיכומיות), ובטבלה הזו יופיעו הקיטים הבודדים
(לפעמים נקרא להם גם התצאות הפרטניות). דרך הטבלה הזו נוכל לחשב תוצאות
סיכומיות עבור מעבדות שלא מחשבות בעצמן, או לאמת\ לפסול תוצאות סיכומיות.</p><ul><li><strong><code>DataFactoryMRR.dbo.LabResults_History</code></strong></li></ul><p>הטבלה אשר מכילה כל שינוי שבוצע בטבלת LabResults שבMRR. ממנה רצים בעיקר
תהליכים שקשורים להנגשה לXRM. כלומר ההנגשה מבוססת על הטבלה הזו ולכן אם יש
עדכון על רשומה בMRR אך היא לא נכתבת לטבלה הזו, היא לא תונגש לXRM. בהקשרי
המסלול כאשר אין בלבול נכנה את הטבלה &quot;היסטורי&quot;.</p><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="עמודות-חשובות"></a>עמודות חשובות<a class="hash-link" href="#עמודות-חשובות" title="Direct link to heading">#</a></h2><blockquote><p>העמודות אשר נתאר לרוב מופיעות
במספר רב של טבלאות לאורך המסלול</p></blockquote><ul><li><strong>SFID</strong></li></ul><p>מזהה רשומה פר הזרמה. Hash שיג&#x27;ונרט עבור כל רשומה שמגיעה ויסחב איתה מהraw
עד הmrr.</p><ul><li><strong>EntityID</strong></li></ul><p>הPK של LabResults - עמודת EntityId (שמורכבת מLabCode || IDNum ||
StickerNumber). אותה עמודה היא גם FK בטבלת SerologyKits וניתן לראות אותה
בעמודת MatchingFinalReultEntityId.\
הPK של SerologyKits - עמודת EntityId (שמורכבת מLabCode || IDNum ||
StickerNumber || MethodCode)</p><p>בעדכון של רשומה אנחנו לא נעדכן את הentity id. זאת מאחר וישנן מעבדות
ששולחות את אותה הבדיקה ולאחר כמה דקות עדכון שלה, בגלל שהם שלחו בפעם
הראשונה תז לא תקין. עדכון באופן כללי זה דבר לגיטימי שאנחנו תומכים בו
באמצעות פעולת merge בפרוצדורות
<code>[DataFactoryOp].[dbo].[Merge_LabResults]</code>
ו<code>[DataFactoryOp].[dbo].[Merge_LabResults_SerologyKits]</code>. הבעיה
היא שעדכון על אחד משדות הPK יוצר בעיה שכן אנחנו מרכיבים את הentity id על
פי כן ואז הרשומה שבעדכון תגיע עם entity id אחר. בפונקציות הmerge אנחנו
עושים את הMerge לפי השדות עצמם (כלומר לפי הid, sticker, labcode ולא לפי
הentity id) ולכן אם מגיע תז עם מקף בפעם הראשונה ותז תקין בפעם השניה,
במהלך המסלול אנחנו נסדר את התז הלא ולידי כך שיעבור לצורתו הולידית. יוצא
שאנחנו מצליחים לעדכן את שתי הרשומות שהתקבלו אחת בשניה ובmrr אכן יש לנו
עדכון ולא כפילות מיותרת. הבעיה היא שהentity id הצביע רק לרשומה האחרונה
שעידכנה אותו ובניטור לצורך העניין הרשומה הראשונה הייתה נראית כמו נפילה.</p><p>הפיתרון הוא לא לעדכן entity id בmerge וכך אוכל לראות בraw את הרשומה
האחרונה שהגיע - זו שעידכנה את הרשומה בmrr, דרך הsfid (שהוא משמש כversion
id למעשה. מזהה רשומה פר הזרמה). וכן לא אפגע בצריכה של הרשומה מצד אלון
שכן לא יהיה בlab results עוד entity id חדש על אותה רשומה.</p><ul><li><strong>ResultRemark</strong></li></ul><p>תקין ששדה result remark יכלול טקסט – זה מהותו. בעבור בדיקות סרולוגיה אנו
נרצה שהשדה הזה יכלול את הציון של הבדיקה הסורולוגית, בעוד שבשדה result
יופיע הסיכום שלה – כלומר חיובי\ שלילי וכו&#x27;.</p><p><strong>ג&#x27;ובים בטאלנד</strong></p><p><strong>ג&#x27;וב ראשי - LabResults_Files_to_SF_MRR קורא לג&#x27;ובים:</strong></p><ul><li><p><strong>Read Files </strong></p><ul><li>קריאה של הקבצים מהכספות לפי תיקיות ובתוכן לפי קבצים, עם כתיבה
לdata factory raw lab results, לאחר מכן עיבוד מידע וולידציות עד
הכתיבה לdata factory op labresults stg. בדרך לstg נכתוב את
הרשומות הרלוונטיות עבור איגום מטושים לטבלה ייעודיות מדיבי op
וכנל על הרשומות הרלוונטיות של סרולוגיה.</li></ul></li><li><p><strong>Swab Pooling </strong></p><ul><li>איגום מטושים<strong>,</strong> לוקחים את המידע מlab results swab pools שבop
וממנו מצליבים עם טבלת דיגומים, עד אשר אנחונ מקבלים את הרשומות
הרלוונטיות של האיגום כבדיקות רגילות לכל דבר, וכותבים לstg.</li></ul></li><li><p><strong>Serology </strong></p><ul><li>חישוב תוצאה סיוכמית לסרולוגיה על ידי משרד הבריאות. שליפה מהטבלה
הרלוונטית בop, וניסיון הצלבה עם קיט תואם מהרשומות שהגיעו מאותה
ריצה או לחלופין לאחר מכן אם לא היית ההצלבה אז עם serology kits
(כלומר קיטים מריצות קודמות), ולבסוף כתיבה לstg.</li></ul></li><li><p><strong>Merge 1 </strong></p><ul><li>נבצע insert or update מstg לmrr lab reuslts עבור pcrים
וסרולוגיה סופי.</li></ul></li><li><p><strong>Merge 2 </strong></p><ul><li>נבצע insert or update מstg לmrr lab reuslts serology kits עבור
סרולוגיה קיטים פרטניים.</li></ul></li><li><p><strong>Retro Data Transformation</strong></p><ul><li>נבצע העשרת מרשם אוכלוסין, אימותי פרוטוקול סרולוגיה וכו&#x27;. העשרות
רטרו אקטיביות</li></ul></li></ul></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/facebook/docusaurus/edit/master/website/docs/doc1.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/doc2"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Document Number 2 »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#עמודות-חשובות" class="table-of-contents__link">עמודות חשובות</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Learn</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/">הטבלאות העיקריות </a></li><li class="footer__item"><a class="footer__link-item" href="/docs/doc2">Second Doc</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow</a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter</a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Legal</h4><ul class="footer__items"><li class="footer__item"><a href="https://opensource.facebook.com/legal/privacy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Privacy</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/terms/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Terms</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/data-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Data Policy</a></li><li class="footer__item"><a href="https://opensource.facebook.com/legal/cookie-policy/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Cookie Policy</a></li></ul></div></div><div class="footer__bottom text--center"><div class="margin-bottom--sm"><a class="footerLogoLink_MyFc" href="/"><img src="/img/labresults.png" alt="Lab Results Logo" class="themedImage_1VuW themedImage--light_3UqQ footer__logo"><img src="/img/labresults.png" alt="Lab Results Logo" class="themedImage_1VuW themedImage--dark_hz6m footer__logo"></a></div><div class="footer__copyright">נכתב על ידי צוות 50% במפעל המידע</div></div></div></footer></div>
<script src="/assets/js/styles.8bfe6c99.js"></script>
<script src="/assets/js/runtime~main.81bbec98.js"></script>
<script src="/assets/js/main.6adc55ad.js"></script>
<script src="/assets/js/common.745e6959.js"></script>
<script src="/assets/js/30.57545e68.js"></script>
<script src="/assets/js/31.cd6b3c16.js"></script>
<script src="/assets/js/935f2afb.0ccb021a.js"></script>
<script src="/assets/js/17896441.7e671925.js"></script>
<script src="/assets/js/b2f90839.db2696c8.js"></script>
</body>
</html>